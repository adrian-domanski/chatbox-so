(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[0],{106:function(e,t,a){},133:function(e,t){},137:function(e,t,a){},138:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(19),s=a.n(o),l=(a(77),a(78),a(10)),c=a(11),i=a(15),u=a(12),m=a(16),p=a(147),h=a(148),g=a(149),d=a(150),f=a(151),E=a(152),v=a(153),O=a(14),y=a(31),b=a.n(y),S=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(n){n({type:"RETURN_ERROR",payload:{status:e,msg:t,id:a}})}},j=function(){var e={headers:{"Content-Type":"application/json"}};if(localStorage.getItem("token")){var t=localStorage.getItem("token");e.headers["x-auth-token"]=t}return e},w=a(13),C=a(160),k=a(139),R=a(140),A=a(141),N=a(142),L=a(143),_=a(144),I=a(145),T=a(146),D=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={modal:!1,error:null,name:"",email:"",password:"",class:""},a.toggle=function(){a.setState(function(e){return{modal:!e.modal}})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(w.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.name,r=t.email,o=t.password;a.props.register({name:n,email:r,password:o})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.error.id!==e.error.id&&"REGISTER_FAIL"===this.props.error.id&&(this.setState({error:this.props.error.msg}),this.props.clearErrors(),setTimeout(function(){t.setState({error:null})},5e3))}},{key:"render",value:function(){var e=this.props.title,t=this.state,a=t.name,n=t.email,o=t.password,s=t.error;return r.a.createElement("div",null,r.a.createElement("div",{onClick:this.toggle},e),r.a.createElement(C.a,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},r.a.createElement(k.a,{toggle:this.toggle},"Registration Form"),r.a.createElement(R.a,null,s?r.a.createElement(A.a,{color:"danger"},s):null,r.a.createElement(N.a,null,r.a.createElement(L.a,null,r.a.createElement("label",{htmlFor:"name"},"Name:"),r.a.createElement(_.a,{type:"text",id:"name",onChange:this.handleChange,value:a,name:"name"})),r.a.createElement(L.a,null,r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement(_.a,{type:"email",id:"email",onChange:this.handleChange,value:n,name:"email"})),r.a.createElement(L.a,null,r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement(_.a,{type:"password",id:"password",onChange:this.handleChange,value:o,name:"password"})))),r.a.createElement(I.a,null,r.a.createElement(T.a,{color:"success",onClick:this.handleSubmit},"Register")," ",r.a.createElement(T.a,{color:"danger",onClick:this.toggle},"Cancel"))))}}]),t}(n.Component),P=Object(O.b)(function(e){return{error:e.errorReducer}},function(e){return{register:function(t){return e(function(e){return function(t){t({type:"LOADING"}),b.a.post("/api/register",e,j()).then(function(e){t({type:"REGISTER_SUCCESS",payload:e.data})}).catch(function(e){t(S(e.response.status,e.response.data.msg,"REGISTER_FAIL")),t({type:"REGISTER_FAIL"})})}}(t))},clearErrors:function(){return e({type:"CLEAR_ERRORS"})}}})(D),G=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={modal:!1,error:null,email:"",password:""},a.toggle=function(){a.setState(function(e){return{modal:!e.modal}})},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(w.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.state,n=t.email,r=t.password;a.props.login({email:n,password:r})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.error.id!==e.error.id&&"LOGIN_FAIL"===this.props.error.id&&(this.setState({error:this.props.error.msg}),this.props.clearErrors(),setTimeout(function(){t.setState({error:null})},5e3))}},{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,n=e.error,o=this.props.title;return r.a.createElement("div",null,r.a.createElement("div",{onClick:this.toggle},o),r.a.createElement(C.a,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},r.a.createElement(k.a,{toggle:this.toggle},"Login Form"),r.a.createElement(R.a,null,n?r.a.createElement(A.a,{color:"danger"},n):null,r.a.createElement(N.a,null,r.a.createElement(L.a,null,r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement(_.a,{type:"email",id:"email",onChange:this.handleChange,value:t,name:"email"})),r.a.createElement(L.a,null,r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement(_.a,{type:"password",id:"password",onChange:this.handleChange,value:a,name:"password"})))),r.a.createElement(I.a,null,r.a.createElement(T.a,{color:"success",onClick:this.handleSubmit},"Log in")," ",r.a.createElement(T.a,{color:"danger",onClick:this.toggle},"Cancel"))))}}]),t}(n.Component),x=Object(O.b)(function(e){return{error:e.errorReducer}},function(e){return{login:function(t){return e((a=t,function(e){e({type:"LOADING"}),b.a.post("/api/login",a,j()).then(function(t){e({type:"LOGIN_SUCCESS",payload:t.data})}).catch(function(t){e(S(t.response.status,t.response.data.msg,"LOGIN_FAIL")),e({type:"LOGIN_FAIL"})})}));var a},clearErrors:function(){return e({type:"CLEAR_ERRORS"})}}})(G),F=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={isOpen:!1},a.toggle=function(){a.setState({isOpen:!a.state.isOpen})},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null,r.a.createElement(h.a,{href:"#"},r.a.createElement(P,{title:"Register"}))),r.a.createElement(p.a,null,r.a.createElement(h.a,{href:"#"},r.a.createElement(x,{title:"Log In"})))),a=r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null,r.a.createElement(h.a,{href:"#",onClick:function(){return e.props.logout()}},"Logout"," ",r.a.createElement("strong",null,"(",this.props.isAuthenticated&&this.props.user.name,")")))),n=this.props.isAuthenticated;return r.a.createElement("div",null,r.a.createElement(g.a,{color:"dark",dark:!0,expand:"md"},r.a.createElement(d.a,{href:"/"},"ChatBox"),r.a.createElement(f.a,{onClick:this.toggle}),r.a.createElement(E.a,{isOpen:this.state.isOpen,navbar:!0},r.a.createElement(v.a,{className:"ml-auto",navbar:!0},n?a:t))))}}]),t}(n.Component),M=Object(O.b)(function(e){return{isAuthenticated:e.authReducer.isAuthenticated,user:e.authReducer.user,isLoading:e.authReducer.isLoading}},function(e){return{logout:function(){return e({type:"LOGOUT_SUCCESS"})}}})(F),U=a(41),B=a(154),Y=(a(106),a(30)),H=a.n(Y),K=a(40),J=a.n(K),W=H()("/"),$=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={newMessage:"",messages:[],events:[],typingTimer:null,errorMsg:""},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(w.a)({},n,r))},a.handleSubmit=function(e){e.preventDefault();var t=a.props.user,n=t.name,r=t.name_color,o=t.rank,s=a.state.newMessage;s.length<255?(W.emit("stopTyping",a.props.user.name),W.emit("input",{msg:s,author:n,author_color:r,author_rank:o}),a.setState({newMessage:""})):(a.setState({errorMsg:"Message might have at most 255 characters"}),setTimeout(function(){a.setState({errorMsg:""})},5e3))},a.handleKeyPress=function(e){var t=a.props.user.name,n=a.state.typingTimer;if(13===e.which)return a.handleSubmit(e);W.emit("typing",t),clearTimeout(n),a.setState({typingTimer:setTimeout(function(){W.emit("stopTyping",t)},5e3)})},a.scrollToBottom=function(){a.chat.scrollTop=a.chat.scrollHeight},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.events;W.on("output",function(t){e.setState({messages:t}),e.scrollToBottom()}),W.on("refresh",function(t){e.setState({messages:[].concat(Object(U.a)(e.state.messages),[t])}),e.scrollToBottom()}),W.on("typing",function(a){var n={type:"TYPING",author:a,msg:"".concat(a," is typing a message...")};t.find(function(e){return"TYPING"===e.type&&e.author===a})||(e.setState({events:[].concat(Object(U.a)(t),[n])}),e.scrollToBottom())}),W.on("stopTyping",function(a){console.log("clear");var n=t.find(function(e){return"TYPING"===e.type&&e.author===a}),r=t.indexOf(n),o=t.splice(r,1);e.setState({events:o})})}},{key:"render",value:function(){var e=this,t=this.props.isAuthenticated,a=this.state,n=a.newMessage,o=a.messages,s=a.events,l=a.errorMsg,c=o.length?o.map(function(e){return r.a.createElement("div",{className:"msg__wrapper",key:e._id},r.a.createElement("span",{style:{color:e.author_color},className:"rank"},e.author_rank),r.a.createElement("div",{className:"message"},r.a.createElement("strong",{style:{color:e.author_color}},e.author,":"," "),r.a.createElement("span",null,e.msg)),r.a.createElement("div",{className:"date"},J()(e.date).format("HH:mm"),"\xa0|\xa0",J()(e.date).format("DD-MM-YYYY")))}):"There aren't any messages yet - let's change that!",i=s.length?s.map(function(e,t){return r.a.createElement("div",{className:"text-muted",key:t},e.msg)}):"";return r.a.createElement("div",{className:"chatbox"},r.a.createElement(B.a,{for:"messages"},"Chat:"),r.a.createElement("div",{className:"messages",ref:function(t){return e.chat=t},id:"messages"},c,i),t?r.a.createElement(L.a,{className:"new_message_form"},r.a.createElement(B.a,{for:"newMessage"},"New message:"),r.a.createElement(_.a,{placeholder:"Say Hello...",type:"textarea",onChange:this.handleChange,name:"newMessage",id:"newMessage",value:n,onKeyPress:this.handleKeyPress}),""!==l?r.a.createElement(A.a,{color:"danger",className:"my-3"},l):null,r.a.createElement(T.a,{color:"success px-5",onClick:this.handleSubmit},"Send")):r.a.createElement("h3",{className:"text-center mt-5 tip"},"Please\xa0",r.a.createElement("a",{href:"/",onClick:function(e){return e.preventDefault()}},r.a.createElement(P,{title:"register"})),"\xa0or\xa0",r.a.createElement("a",{href:"/",onClick:function(e){return e.preventDefault()}},r.a.createElement(x,{title:"log in"})),"\xa0to add new message"))}}]),t}(n.Component),q=Object(O.b)(function(e){return{isAuthenticated:e.authReducer.isAuthenticated,user:e.authReducer.user}})($),z=a(155),Q=a(156),V=a(157),X=a(158),Z=a(159),ee=H()("/"),te=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={user_count:0,spamers:[]},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;ee.on("active",function(t){var a=Math.floor(t/2);e.setState({user_count:a})}),ee.on("spamers",function(t){e.setState({spamers:t})})}},{key:"render",value:function(){var e=this.state,t=e.user_count,a=e.spamers,n=a.length?a.map(function(e,t){return r.a.createElement("li",{key:e._id},t+1,". ",e.name," (",e.msg_count,")")}):"Loading...";return r.a.createElement(z.a,{className:"info"},r.a.createElement(Q.a,{tag:"h3",className:"text-center"},"Info:"),r.a.createElement(V.a,null,r.a.createElement(X.a,{className:"text-center"},r.a.createElement("strong",null,"Active users"),":"," ",r.a.createElement("span",{className:"text-success"},t)),r.a.createElement(X.a,{className:"text-center"},r.a.createElement("strong",null,"Spamers: ")),r.a.createElement("ul",{className:"text-center spamers"},n)),r.a.createElement(Z.a,{className:"text-muted text-center copy"},"Copyright \xa9 Adison"))}}]),t}(n.Component),ae=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.isAuthenticated||this.props.auth()}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(M,null),r.a.createElement("div",{className:"py-5 content"},r.a.createElement(q,null),r.a.createElement(te,null)),r.a.createElement(P,null))}}]),t}(n.Component),ne=Object(O.b)(function(e){return{isAuthenticated:e.authReducer.isAuthenticated}},function(e){return{auth:function(){return e(function(e){e({type:"LOADING"}),b.a.get("/api/auth",j()).then(function(t){e({type:"USER_LOADED",payload:t.data})}).catch(function(t){e(S(t.response.status,t.response.data.msg)),e({type:"AUTH_FAIL"})})})}}})(ae);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var re=a(20),oe=a(71);function se(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function le(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?se(a,!0).forEach(function(t){Object(w.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):se(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var ce={isAuthenticated:!1,user:null,token:localStorage.getItem("token"),isLoading:!0},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOADING":return le({},e,{isLoading:!0});case"USER_LOADED":return le({},e,{isAuthenticated:!0,user:t.payload,token:localStorage.getItem("token"),isLoading:!1});case"LOGIN_SUCCESS":case"REGISTER_SUCCESS":return localStorage.setItem("token",t.payload.token),le({},e,{isAuthenticated:!0,user:t.payload.user,token:localStorage.getItem("token"),isLoading:!1});case"LOGIN_FAIL":case"AUTH_FAIL":case"LOGOUT_SUCCESS":return localStorage.removeItem("token"),le({},e,{isAuthenticated:!1,user:null,token:null,isLoading:!1});case"LOADING":return le({},e,{isLoading:!0});default:return e}};function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function me(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(a,!0).forEach(function(t){Object(w.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var pe={msg:null,status:null,id:null},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RETURN_ERROR":var a=t.payload,n=a.msg,r=a.status,o=a.id;return me({},e,{msg:n,status:r,id:o});case"CLEAR_ERRORS":return{msg:null,status:null,id:null};default:return e}},ge=Object(re.c)({authReducer:ie,errorReducer:he}),de=(a(137),Object(re.e)(ge,Object(re.d)(Object(re.a)(oe.a))));s.a.render(r.a.createElement(O.a,{store:de},r.a.createElement(ne,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},72:function(e,t,a){e.exports=a(138)},78:function(e,t,a){}},[[72,1,2]]]);
//# sourceMappingURL=main.f50d1a0f.chunk.js.map